isPartialSolution(a,b,c,d      )-> a+b = b+c+d;
isPartialSolution(a,b,c,d,e,f  )-> a+b = b+c+d = d+e+f;
findG            (a,b,c,d,e,f  )-> a+b-f;
isSolution       (a,b,c,d,e,f,g)-> a+b = b+c+d = d+e+f = f+g;

//*See: http://rosettacode.org/wiki/4-rings_or_4-squares_puzzle
main->begin
  print(//!~Four rings:
     ___   ___   ___   ___
    /   \ /   \ /   \ /   \
   /     X     X     X     \
  (   A (B) C (D) E (F) G   )
   \     X     X     X     /
    \___/ \___/ \___/ \___/~);
  print('The solutions for 1..7 (unique) are: ');
  permutations([1..7]).pEach(p,isSolution@p ? p : void).each(s,print('  ',s));
  print('The solutions for 3..9 (unique) are: ');
  permutations([3..9]).pEach(p,isSolution@p ? p : void).each(s,print('  ',s));
  print('The number of solutions for 0..9 (nonunique) is: ',
  cross([0..9],[0..9],[0..9],[0..9]).pEach(abcd,
    begin
      isPartialSolution@abcd
      ? cross([0..9],[0..9]).pEach(ef,
          begin
            local abcdef:=abcd|ef;
            isPartialSolution@abcdef and (0<=(findG@abcdef)<=9)
            ? 1
            : 0;
          end,+)
      : void;
    end,+));
end;
